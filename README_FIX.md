# üöÄ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è 500 –æ—à–∏–±–∫–∏

## –í–∞—Ä–∏–∞–Ω—Ç –ê: –ü–æ–ª–Ω–æ—Å—Ç—å—é –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π (–†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø) ‚≠ê

### –ù–∞ –≤–∞—à–µ–º —Å–µ—Ä–≤–µ—Ä–µ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ –æ–¥–Ω—É –∫–æ–º–∞–Ω–¥—É:

```bash
cd /root/telespam/telespam
git fetch origin
git checkout origin/fix/add-user-500-error -b fix/add-user-500-error
```

–ï—Å–ª–∏ –≤–µ—Ç–∫–∞ –µ—â–µ –Ω–µ –Ω–∞ GitHub, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –í–∞—Ä–∏–∞–Ω—Ç –ë –Ω–∏–∂–µ.

---

## –í–∞—Ä–∏–∞–Ω—Ç –ë: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Å–∫—Ä–∏–ø—Ç (1 –∫–æ–º–∞–Ω–¥–∞)

### –®–∞–≥ 1: –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Å–∫—Ä–∏–ø—Ç –Ω–∞ —Å–µ—Ä–≤–µ—Ä

```bash
cd /root/telespam/telespam

# –°–∫–∞—á–∞–π—Ç–µ —Å–∫—Ä–∏–ø—Ç
curl -o apply_fix.sh https://raw.githubusercontent.com/mrktguru/telespam/fix/add-user-500-error/apply_fix.sh

# –ò–ª–∏ —Å–æ–∑–¥–∞–π—Ç–µ –≤—Ä—É—á–Ω—É—é (—Å–º. –Ω–∏–∂–µ)
```

### –®–∞–≥ 2: –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç

```bash
chmod +x apply_fix.sh
./apply_fix.sh
```

**–°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:**
- ‚úÖ –°–æ–∑–¥–∞—Å—Ç –≤–µ—Ç–∫—É `fix/add-user-500-error`
- ‚úÖ –°–¥–µ–ª–∞–µ—Ç backup —Ñ–∞–π–ª–æ–≤ (*.backup)
- ‚úÖ –ü—Ä–∏–º–µ–Ω–∏—Ç –≤—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫ `mock_sheets.py`
- ‚úÖ –ü—Ä–∏–º–µ–Ω–∏—Ç –≤—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫ `web_app.py`
- ‚úÖ –°–æ–∑–¥–∞—Å—Ç —Ç–µ—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª
- ‚úÖ –ó–∞–ø—É—Å—Ç–∏—Ç —Ç–µ—Å—Ç—ã
- ‚úÖ –ó–∞–∫–æ–º–º–∏—Ç–∏—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è

### –®–∞–≥ 3: Push –∏ —Å–æ–∑–¥–∞–Ω–∏–µ PR

```bash
git push -u origin fix/add-user-500-error

# –°–æ–∑–¥–∞–π—Ç–µ PR –Ω–∞:
# https://github.com/mrktguru/telespam/compare/main...fix/add-user-500-error
```

### –®–∞–≥ 4: –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–∞

```bash
sudo systemctl restart telespam-web
sudo systemctl status telespam-web
```

---

## –í–∞—Ä–∏–∞–Ω—Ç –í: –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö —Ñ–∞–π–ª–æ–≤ —Å –º–æ–µ–π –≤–µ—Ç–∫–∏

–ï—Å–ª–∏ —É –Ω–∞—Å –æ–±—â–∏–π –¥–æ—Å—Ç—É–ø –∫ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—é, —è –º–æ–≥—É —Å–æ–∑–¥–∞—Ç—å –∫–æ–º–º–∏—Ç—ã –≤ –≤–µ—Ç–∫–µ, –∫–æ—Ç–æ—Ä—É—é –≤—ã –ø–æ—Ç–æ–º –ø—Ä–æ—Å—Ç–æ –∑–∞–±–µ—Ä–µ—Ç–µ:

```bash
cd /root/telespam/telespam

# –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ –≤–µ—Ç–∫–∏
git fetch --all

# –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è –Ω–∞ –º–æ—é –≤–µ—Ç–∫—É
git checkout fix/add-user-500-error

# –ï—Å–ª–∏ –Ω—É–∂–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å
git pull origin fix/add-user-500-error

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–∏—Å
sudo systemctl restart telespam-web
```

---

## üìù –°–æ–¥–µ—Ä–∂–∏–º–æ–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Å–∫—Ä–∏–ø—Ç–∞

–ï—Å–ª–∏ —Ö–æ—Ç–∏—Ç–µ —Å–æ–∑–¥–∞—Ç—å —Å–∫—Ä–∏–ø—Ç –≤—Ä—É—á–Ω—É—é:

```bash
nano apply_fix.sh
```

–°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞ `apply_fix.sh` –∏–∑ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è –∏–ª–∏ –∏–∑ —ç—Ç–æ–≥–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞.

---

## üß™ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã

–ü–æ—Å–ª–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:

```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç
python3 test_add_user_fix.py

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–∏—Å–∞
sudo systemctl status telespam-web

# –û—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ
# http://your-server:5000/users
# –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –¥–æ–±–∞–≤–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
```

---

## üîÑ –û—Ç–∫–∞—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π (–µ—Å–ª–∏ —á—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫)

```bash
# –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏–∑ backup
cp mock_sheets.py.backup mock_sheets.py
cp web_app.py.backup web_app.py

# –ò–ª–∏ –≤–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞ main
git checkout main
git branch -D fix/add-user-500-error
```

---

## ‚úÖ –ß—Ç–æ –±—É–¥–µ—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ

–ü–æ—Å–ª–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è:
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —á–µ—Ä–µ–∑ –≤–µ–± —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ –ù–µ—Ç 500 –æ—à–∏–±–æ–∫
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –ø–æ–ª–µ–π (username –∏–ª–∏ user_id –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã)
- ‚úÖ –ü–æ–Ω—è—Ç–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö
- ‚úÖ –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç

---

## üí¨ –ü–æ–º–æ—â—å

–ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç:

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏:
   ```bash
   sudo journalctl -u telespam-web -f
   ```

2. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏:
   ```bash
   pwd
   # –î–æ–ª–∂–Ω–æ –±—ã—Ç—å: /root/telespam/telespam
   ```

3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ Python –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã:
   ```bash
   pip install -r requirements.txt
   ```

---

## üìä –°—Ç–∞—Ç—É—Å

- ‚úÖ –°–∫—Ä–∏–ø—Ç —Å–æ–∑–¥–∞–Ω –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω
- ‚úÖ –í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∑–∞–∫–æ–º–º–∏—á–µ–Ω—ã –≤ –≤–µ—Ç–∫—É `fix/add-user-500-error`
- ‚úÖ –¢–µ—Å—Ç—ã –Ω–∞–ø–∏—Å–∞–Ω—ã –∏ –ø—Ä–æ—Ö–æ–¥—è—Ç
- ‚è≥ –û–∂–∏–¥–∞–µ—Ç –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –Ω–∞ –≤–∞—à–µ–º —Å–µ—Ä–≤–µ—Ä–µ

**–°–∞–º—ã–π –ø—Ä–æ—Å—Ç–æ–π —Å–ø–æ—Å–æ–±: –í–∞—Ä–∏–∞–Ω—Ç –ë - –∑–∞–ø—É—Å—Ç–∏—Ç—å `./apply_fix.sh` –æ–¥–Ω–æ–π –∫–æ–º–∞–Ω–¥–æ–π!** üöÄ
